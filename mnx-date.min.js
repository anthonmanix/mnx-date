!function(a){"use strict";function c(a){var d,c="";for(d=0;7>d;d++)c+='<th title="'+a[d]+'">'+a[d][0]+"</th>";return'<table class="'+b+'-calendar"><thead><tr>'+c+"</tr></thead></table>"}function d(a,c,d,e,f,g,h){var l,i=new Date(a,c,-new Date(a,c,-d).getDay()),j=new Date(e).setHours(0,0,0,0),k="";for(l=0;42>l;l+=1)l&&0===l%7&&(k+="</tr><tr>"),k+='<td title="'+h("date")(i,"fullDate")+'" class="',i.getMonth()!==c&&(k+=b+"-alt "),+i===j&&(k+=b+"-sel"),k+=f&&f>i||g&&i>g?'" disabled>':'" data-date="'+ +i+'">',k+=i.getDate()+"</td>",i.setDate(i.getDate()+1);return"<tbody><tr>"+k+"</tr></tbody>"}function e(e,f){return{restrict:"A",require:"ngModel",link:function(g,h,i,j){function z(b){var c=k.getMonth();b&&(b.stopPropagation(),b.preventDefault(),k.setMonth(c+ +a.element(b.target||b.srcElement).attr("data-dir")),c=k.getMonth()),u.text(n.MONTH[c]+" "+k.getFullYear()),y.html(d(k.getFullYear(),c,p,j.$modelValue,l,m,e))}function A(b){var c=b.target||b.srcElement,d=a.element(c).attr("data-date");b.stopPropagation(),b.preventDefault(),d&&(k=new Date(+d),j.$setViewValue(e("date")(k,o)),j.$render())}function B(b){var c=a.isNumber(b.which)?b.which:a.isNumber(b.keyCode)?b.keyCode:0;28>c||b.altKey||b.ctrlKey||/[\d\b\.\-\/]/.test(String.fromCharCode(c))||b.preventDefault()}var k,l,m,n=f.DATETIME_FORMATS,o=i.mnxFormat||n.shortDate,p=i.mnxFirstday||0,q=o.replace(/[^dmy]*([dmy])+[^dmy]*/gi,"$1").toLocaleLowerCase(),r=n.DAY.slice(p,7).concat(n.DAY.slice(0,p)),s=a.element('<div class="'+b+'-container"></div>'),t=a.element('<div class="'+b+'-head"></div>'),u=a.element('<div class="'+b+'-btn-mode"></div>'),v=a.element('<div class="'+b+'-btn-prev" data-dir="-1">&lt;</div>'),w=a.element('<div class="'+b+'-btn-next" data-dir="1">&gt;</div>'),x=a.element(c(r)),y=a.element("<tbody></tbody>");i.mnxMin&&g.$watch(i.mnxMin,function(a){a?(l=new Date(a),l.setHours(0,0,0,0),j.$validators.min=function(a){return!l||a>=l},j.$validate()):(l=null,delete j.$validators.min)}),i.mnxMax&&g.$watch(i.mnxMax,function(a){a?(m=new Date(a),m.setHours(0,0,0,0),j.$validators.max=function(a){return!m||m>=a},j.$validate()):(m=null,delete j.$validators.max)}),j.$parsers.push(function(a){var c,d,e,f,b=a.match(/(\d+)/g);return b&&3===b.length&&(c=+b[q.indexOf("y")],d=+b[q.indexOf("m")]-1,e=+b[q.indexOf("d")],f=new Date(c,d,e),c===f.getFullYear()&&d===f.getMonth()&&e===f.getDate())?(j.$modelValue=f,k=new Date(j.$modelValue),z(),new Date(j.$modelValue)):a}),j.$formatters.push(function(b){return a.isDate(b)&&(k=new Date(b),z(),b=e("date")(b,o)),b}),j.$validators.date=function(b){return b?a.isDate(b):!0},h.attr("placeholder",o),s.append(t.append(u).append(v).append(w)).append(x.append(y)),h.on("focus",function(){s.css({top:h[0].offsetTop+h[0].offsetHeight+"px",left:h[0].offsetLeft+"px"}),h.after(s),v.on("mousedown",z),w.on("mousedown",z),y.on("mousedown",A),h.on("keypress",B),k=j.$modelValue&&new Date(j.$modelValue)||new Date,k.setHours(0,0,0,0),z(),h.on("blur",function a(){j.$modelValue&&j.$valid&&(j.$setViewValue(e("date")(j.$modelValue,o)),j.$render()),h.off("keypress",B),h.off("blur",a),s.remove()})})}}}var b="mnx-date";e.$inject=["$filter","$locale"],a.module("mnxDate",[]).directive("mnxDate",e)}(window.angular);
